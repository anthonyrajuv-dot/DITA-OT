<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE topic PUBLIC "-//OASIS//DTD DITA Topic//EN" "http://docs.oasis-open.org/dita/v1.1/OS/dtd/topic.dtd">
<topic id="topic-1">
  <title>Scriptorium PDF Plugin</title>
  <shortdesc>Copyright 2011, Scriptorium Publishing Services, Inc.</shortdesc>
  <prolog>
    <author>David James Kelly</author>
    <author>Simon Bate</author>
    <copyright>
      <copyryear year="2011"/>
      <copyrholder>Scriptorium</copyrholder>
    </copyright>
  </prolog>

  <body>
    <note>The information presented in this document is considered accurate as of the date of publication, but does not represent an official
        list of features for this product or service.
    </note>
    <p>Scriptorium modified the DITA Open Toolkit's PDF2 plugin to provide a variety of enhancements that are frequently needed in the
      publishing industry. In some cases, the modifications can be controlled by setting values in the basic-settings.xsl file. This
      document describes the enhancements and controls.</p>
    <p>These enhancements assume the following regarding the source documents: </p>
    <ul>
      <li>Source files use DITA version 1.1 or later. Otherwise, some of the earlier, unmodified style sheets may be used.</li>
      <li>The plugin has been tested with DITA OT 1.5.2. Earlier version of the DITA OT may work, but have not been tested.</li>
      <li>Books are constructed with bookmaps. Ditamaps have not yet been qualified for use with this plugin.</li>
      <li>Top-level book elements such as &lt;notices&gt;, &lt;preface&gt;, &lt;chapter&gt;, and &lt;appendix&gt; have hrefs pointing to
        valid topics. Otherwise the headings for these book parts will not appear correctly.</li>
    </ul>
    <p>Following are the modifications made by Scriptorium in the SPDF plugin:</p>
    <ol>
      <li>
        <p>Added a simplified method for rendering an index using FOP. Previously, only Antenna House and RenderX provided indexing with the
          DITA Open Toolkit.</p>
        <p>This method has certain limitations; for example, if there is more than one identical
          indexentry on a page, each identical indexentry after the first on that page will cause
          the page number to be repeated. However, in general, the results should be satisfactory
          for moderately indexed content.</p>
        <p>Also removed checks for the presence of the XEP FO processor for index formatting. Indexes are now formatted similarly for FOP
          and Antenna House.</p>
        <p>Multiple identical index entries on a single page result in multiple instance of the same page number being listed for that index
          entry.</p>
        <p>The "continued" entry has been removed. This entry appeared when index entries with long secondary lists break across a column or
          page. This function depended on a RenderX-based function that is not supported by FOP.</p>
      </li>
      <li>
        <p>Modified simple-page-master definitions and basic-settings so <varname>margin-left="{$page-margin-left}"</varname>, etc., are not
          used for both left-hand and right-hand pages. (This arrangement is prohibitive to creating pages with offset margins for
          printing.) Changed the variables from <varname>page-margin-left</varname> to <varname>page-margin-outer</varname> and
            <varname>page-margin-right</varname> to <varname>page-margin-inner</varname>, then changed the usage in all the
            <varname>simple-page-masters</varname> to use the appropriate variable for the <varname>margin-left</varname> and
            <varname>margin-right</varname> attributes, depending on whether it was an odd or even page. Page offsets for odd and even pages
          can now be set with the <varname>page-margin-outer</varname> and <varname>page-margin-inner</varname> variables in
          basic-settings.xml without having to modify the simple-page-masters.</p>
        <p>We assume that all first pages are odd pages and all last pages are even pages.</p>
      </li>
      <li>
        <p>Changed the display-align settings in the <varname>fo:region-before</varname> and <varname>fo:region-after</varname> attributes
          of all <varname>simple-page-master</varname> elements so the header content is bottom-aligned and the footer content is
          top-aligned instead of the other way around. This change enables overflow text to stack upward in the header area and downward in
          the footer area.</p>
      </li>
      <li>
        <p>Added "last" simple-page-masters for the Glossary and Index pages and changed the page-sequence-masters to include page padding.
          (This function assumes that the glossary and index are padded to an even number of pages.) </p>
      </li>
      <li>
        <p>Changed static-content attribute sets to use the <varname>page-margin-outer</varname> and <varname>page-margin-inner</varname>
          values for the margins of headers and footers, overriding the previous default value of 10pt.</p>
      </li>
      <li>
        <p>Modified the header and footer contents and formats. Headers include rules. The even-page header contains the chapter/appendix
          name, the odd-page header contains the name of the first second-level heading on the page, and the footers contain the page number
          justified on the outer margin.</p>
        <p>Vertical spacing and width for the header and footer rules are controlled with variables in the basic-settings.xsl file. The
          controlling variables are (with default values): </p>
        <ul>
          <li>Header text-to-rule depth: <varname>text-to-rule="6pt"</varname></li>
          <li>Rule-to-body depth: <varname>rule-to-body="12pt"</varname></li>
          <li>Rule thickness: <varname>rule-thickness="0.25pt"</varname></li>
          <li>Rule style: <varname>rule-style="solid"</varname>. For no rule, change "solid" to "none". Other supported values are those for
            the border-style attribute for XSL-FO. </li>
        </ul>
      </li>
      <li>
        <p>Added separate font control for headers and footers using variables in the basic-settings.xsl file. The settings are as
          follows:</p>
        <ul>
          <li>Header font size: headfoot-font-size="10pt"</li>
          <li>Header font family: headfoot-font-family="Serif"</li>
          <li>Header font family: headfoot-font-weight="normal". Another valid value is "bold".</li>
          <li>Header font family: headfoot-font-style="normal". Another valid value is "italic".</li>
        </ul>
      </li>
      <li>
        <p>Modified the page sequences to provide different formatting for cover/colophon pages and frontmatter pages.</p>
        <p>The cover page and other pages inside the first page sequence no longer receive headers and footers. Notices preceding the table
          of contents now use the frontmatter page sequence, which provides headers and footers. The page numbers are roman rather than
          arabic.</p>
        <p>By default the first frontmatter page sequence contains only the title page, but copyright notice, colophon, and half-titles can
          be added if needed. The copyright information typically comes from the bookmeta area of the bookmap.</p>
      </li>
      <li>
        <p>Modified frontmatter processing so it processes notices, preface, booklists, etc., in the order they occur within the
            <varname>frontmatter</varname> element. This modification enables the author to control order of frontmatter sections rather
          than leaving the order of front matter to the discretion of the stylesheets.</p>
        <p>Also modified bookmarks processing to create a bookmark for the table of contents in the order it appears in the frontmatter
          element rather than always at the beginning.</p>
      </li>
      <li>Added a bookmark for the title page.</li>
      <li>
        <p>Modified calculation of the current-topic-number marker so it contains the current chapter or appendix number, and passed the
          topic type value to the headers so Chapter # and Appendix # appear with the chapter or appendix title. The labels can be disabled
          in basic-settings.xsl with the <varname>labels-in-headers</varname> variable.</p>
      </li>
      <li>
        <p>Modified the formatting of chapter-level first-page static content (the chapter number and title) so they provide a more generic
          basis for format changes.</p>
      </li>
      <li>
        <p>Placed the miniTOC inline with the first topic's body text since the text of the first topic body may extend beyond one page.
          Modified the indents to be consistent with other title/body structures.</p>
      </li>
      <li>
        <p>Added a new variable in basic-settings.xsl to control the size of the default monospace font; updated attribute sets to use this
          variable for block-level elements where monospace fonts are specified. </p>
      </li>
      <li>
        <p>In basic-settings.xsl, added variables to control the index indent and index left margin. The indent is the amount that wrapped
          text is indented. The left margin is the amount that secondary entries are indented beneath the primary entry.</p>
      </li>
      <li>
        <p>Changed the position of the figure title to precede the figure. This arrangement is often preferred in PDF documents (as well as
          HTML) because the title is the target of links, and when the link is selected, the target is placed at the top of the viewing
          area. If the title is below the figure, the desired figure is not displayed, and if another figure follows the figure title, the
          audience can mistakenly assume that the displayed figure is the one associated with the selected title. To correct this problem
          the image should appear beneath its associated title.</p>
      </li>
      <li>
        <p>Removed the table formatting and hand icon for notes. The note label is indented the same as text and has the label inline with
          the first paragraph within the note element. In the default format, the table caused the note text to be indented half the width
          of the text column.</p>
      </li>
      <li>
        <p>Added several variables in basic-settings.xsl for control of fonts and indents in the table of contents.</p>
      </li>
      <li>
        <p>For the table of contents, changed text-align="left" to text-align="justify". This setting prevents the "wobble" observed in the
          right-alignment of stacked page numbers in the table of contents.</p>
      </li>
      <li>
        <p>Added controls to reset figure and table numbering by chapter and to control the appearance of numbering. When chapter numbering
          is enabled, tables and figures have their numbers restarted at the beginning of each chapter, appendix, or other top-level topic.
          The chapter/appendix prefix is also added to the table or figure number. Cross-references to tables and figures include the
          chapter or appendix number prefixes.</p>
      </li>
      <li>Changed numbered list labels from left-aligned to right-aligned for consistent spacing between label and text. </li>
      <li>
        <p>Provided support for the expanse attribute for the fig element.</p>
        <p>The expanse attribute is used to control the horizontal position of the figure. In Scriptorium's implementation, the figure title
          does not shift, but other elements within the fig element will shift. While all legal values for the expanse attribute are
          supported, the only value that moves the figure from the current text indent is "page", which places the left edge of the figure
          against the left margin of the page.</p>
        <p>One limitation of the shift is that shift is only for the amount of the current side column width. If the fig element has more
          than one ancestor that has a margin specified for it, or if it is embedded in an ancestor that uses a margin larger than the side
          column width, the figure is still back-indented only by the width of the side column width.</p>
      </li>
      <li>Added the ability to turn on or turn off the borders for table cells when frames="all" is present on a table. Currently the
        "frames" attribute on the table element only controls the exterior borders. The control is "cell-frames" in basic-settings.xsl.</li>
      <li>Added a control for whether the bottom border appears or does not appear when a table breaks across a page.</li>
      <li>Modified the TOC so very long entries have line breaks when using FOP.</li>
      <li>Added a control in basic-settings.xsl for suppressing the Notices entries in the table of contents. The controlling variable is
        suppress-notices-in-toc.</li>
      <li>Added the Index to the table of contents if it is available.</li>
      <li>Added a control to suppress indexing, regardless of FO processor type. The controlling variable is no-index in
        basic-settings.xsl.</li>
      <li>Added index font size variables for the entry text and for the alphabetic labels. </li>
      <li>Added variables for the current (time of processing) date and time.</li>
      <li>Added date and time to the footers. Also added "date-in-footers" and "time-in-footers" variables in basic-settings to control the
        presence of these items.</li>
      <li>Added processing for unsupported new note types in DITA 1.2: warning and notice.</li>
      <li>Modified table indents to correct a problem in FOP. When using FOP, the contents of table cells inherit the margin settings of
        ancestor elements, resulting in excessive margin-left indents. The correction is to subtract the value of side-col-width from the
        margin-left setting for the table cell content. This fix was applied to dl, simpletable, and table.</li>
      <li>Modified formats for related links: added spacing above "Related Links" title and added "keep" so a link's short description
        remains on the page with its entry.</li>
    </ol>
  </body>
</topic>
