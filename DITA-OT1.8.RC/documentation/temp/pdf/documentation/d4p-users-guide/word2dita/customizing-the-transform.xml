<?xml version="1.0" encoding="utf-8"?><?workdir /C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\temp\pdf\documentation\d4p-users-guide\word2dita?><?workdir-uri file:/C:/Users/PBentley/Downloads/dita4publishers-0.9.18/documentation/temp/pdf/documentation/d4p-users-guide/word2dita/?><?path2project ..\..\?><?path2project-uri ../../?><concept xmlns:ditaarch="http://dita.oasis-open.org/architecture/2005/" id="conceptId" ditaarch:DITAArchVersion="1.2" domains="(topic hi-d)       (topic indexing-d)      (topic d4p_formatting-d)      (topic d4p_ruby-d)      a(props d4p_renditionTarget)      (topic d4p_classification-d)      (topic d4p_math-d)      (topic d4p_simplebib-d)      (topic d4p_variables-d)      (topic d4p_verse-d)      (topic xml-d)      (topic abbrev-d)     " class="- topic/topic concept/concept " xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide\word2dita\customizing-the-transform.xml" xtrc="concept:1;3:25">
 <title class="- topic/title " xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide\word2dita\customizing-the-transform.xml" xtrc="title:1;4:9">Extending and Overriding the Word to DITA Transform</title>
 <shortdesc class="- topic/shortdesc " xtrc="shortdesc:1;5:13" xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide\word2dita\customizing-the-transform.xml">How to customize the XSLT processing to handle special cases</shortdesc>
  <prolog class="- topic/prolog " xtrc="prolog:1;6:11" xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide\word2dita\customizing-the-transform.xml">
    <author class="- topic/author " xtrc="author:1;5:21" xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide.ditamap">W. Eliot Kimber</author><metadata class="- topic/metadata " xtrc="metadata:1;7:15" xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide\word2dita\customizing-the-transform.xml">
      <keywords class="- topic/keywords " xtrc="keywords:1;8:17" xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide\word2dita\customizing-the-transform.xml">
        <indexterm class="- topic/indexterm " xtrc="indexterm:1;9:20" xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide\word2dita\customizing-the-transform.xml"/>
      </keywords>
    <prodinfo class="- topic/prodinfo " xtrc="prodinfo:1;7:27" xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide.ditamap">
    <prodname class="- topic/prodname " xtrc="prodname:1;8:15" xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide.ditamap">DITA For Publishers</prodname>
    <vrmlist class="- topic/vrmlist " xtrc="vrmlist:1;9:14" xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide.ditamap">
      <vrm class="- topic/vrm " version="0.9.16" xtrc="vrm:1;11:27" xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide.ditamap"/>
    </vrmlist>
    </prodinfo></metadata>
  </prolog>
 <conbody class="- topic/body  concept/conbody " xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide\word2dita\customizing-the-transform.xml" xtrc="conbody:1;13:11">
   <p class="- topic/p " xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide\word2dita\customizing-the-transform.xml" xtrc="p:1;14:7">Any transformation driven by a declarative mapping will be limited in what can be done purely through the mapping. Thus the Word-to-DITA process is designed to be extended and customized to handle special cases.</p>
    <p class="- topic/p " xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide\word2dita\customizing-the-transform.xml" xtrc="p:2;15:8">The Word-to-DITA transformation is a three-phase transformation:<ul class="- topic/ul " xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide\word2dita\customizing-the-transform.xml" xtrc="ul:1;15:76">
      <li class="- topic/li " xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide\word2dita\customizing-the-transform.xml" xtrc="li:1;16:11">Phase one processes the input DOCX document.xml file (and other files as needed) to generate an intermediate "simple word processing" document. The process is not intended to be extended. The "simple" document reflects the original paragraph and character run data from the Word document annotated with the details from the style-to-tag mapping.</li>
      <li class="- topic/li " xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide\word2dita\customizing-the-transform.xml" xtrc="li:2;17:11">Phase two processes the intermediate "simple" document to generate the initial result DITA XML.</li>
      <li class="- topic/li " xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide\word2dita\customizing-the-transform.xml" xtrc="li:3;18:11">Phase three is the "final fixup" phase, which processes the inital result DITA XML to generate the final DITA XML. By default the final-fixup is just a passthrough stage but can be extended to do cleanup as needed.</li>
      </ul></p>
    <p class="- topic/p " xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide\word2dita\customizing-the-transform.xml" xtrc="p:3;20:8">In addition, the transformation provides default rules for generating output filenames and for generating element IDs, both of which can be overridden.</p>
    <p class="- topic/p " xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide\word2dita\customizing-the-transform.xml" xtrc="p:4;21:8">You extend and override the base transformation by creating a top-level XSLT document that imports the docx2dita.xsl transformation from the word2dita Toolkit plugin and implements any override or extension templates required. You can deploy this override in a separate Open Toolkit plugin that depends on the base word2dita plugin and that defines its own transformation type or you can specify the <parmname class="+ topic/keyword pr-d/parmname " xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide\word2dita\customizing-the-transform.xml" xtrc="parmname:1;21:418">w2d.word2dita.xslt</parmname> Ant parameter with the full path and filename of your custom transformation.</p>
    <p class="- topic/p " xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide\word2dita\customizing-the-transform.xml" xtrc="p:5;22:8">The second and third processing phases are implemented by the <filepath class="+ topic/ph sw-d/filepath " xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide\word2dita\customizing-the-transform.xml" xtrc="filepath:1;22:80">simple2dita.xsl</filepath> file.</p>
    <p class="- topic/p " xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide\word2dita\customizing-the-transform.xml" xtrc="p:6;23:8">The extension points provided are:<ul class="- topic/ul " xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide\word2dita\customizing-the-transform.xml" xtrc="ul:2;23:46">
      <li class="- topic/li " xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide\word2dita\customizing-the-transform.xml" xtrc="li:4;24:11">The "final fixup" phase, which you can extend by implementing templates in the "final-fixup" mode. These templates operate on the DITA XML produced by the the second phase and must produce valid DITA markup as their output. Note that the XML handled by the final-fixup mode doesn't have any associated schema or DTD at that point, so there are no <xmlatt class="+ topic/keyword xml-d/xmlatt " xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide\word2dita\customizing-the-transform.xml" xtrc="xmlatt:1;24:366">class</xmlatt> attributes to key on. This means you must use templates that match on the element type names, rather than on <xmlatt class="+ topic/keyword xml-d/xmlatt " xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide\word2dita\customizing-the-transform.xml" xtrc="xmlatt:2;24:498">class</xmlatt> attribute values.</li>
      <li class="- topic/li " xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide\word2dita\customizing-the-transform.xml" xtrc="li:5;25:11">The "generate-id" and "topic-name" modes can be overridden to provide custom ID generation logic. The mappings for individual paragraph and character styles can specify a named "ID generator" value that is then passed as a parameter ot the generate-id mode. Custom ID generator code can use that parameter to select the appropriate ID generation logic.</li>
      <li class="- topic/li " xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide\word2dita\customizing-the-transform.xml" xtrc="li:6;26:11">The "topic-url"mode can be overridden to implement custom rules for constructing result topic filenames.</li>
      <li class="- topic/li " xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide\word2dita\customizing-the-transform.xml" xtrc="li:7;27:11">The "map-url" mode can be overridden to implement custom rules for construction result map filenames.</li>
      </ul></p>
 </conbody>
</concept>