<?xml version="1.0" encoding="utf-8"?><?workdir /C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\temp\pdf\documentation\d4p-users-guide\word2dita?><?workdir-uri file:/C:/Users/PBentley/Downloads/dita4publishers-0.9.18/documentation/temp/pdf/documentation/d4p-users-guide/word2dita/?><?path2project ..\..\?><?path2project-uri ../../?><concept xmlns:ditaarch="http://dita.oasis-open.org/architecture/2005/" id="conceptId" ditaarch:DITAArchVersion="1.2" domains="(topic hi-d)       (topic indexing-d)      (topic d4p_formatting-d)      (topic d4p_ruby-d)      a(props d4p_renditionTarget)      (topic d4p_classification-d)      (topic d4p_math-d)      (topic d4p_simplebib-d)      (topic d4p_variables-d)      (topic d4p_verse-d)      (topic xml-d)      (topic abbrev-d)     " class="- topic/topic concept/concept " xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide\word2dita\sample-customization-transform.xml" xtrc="concept:1;3:25">
 <title class="- topic/title " xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide\word2dita\sample-customization-transform.xml" xtrc="title:1;4:9">Sample Custom Word-to-DITA XSLT Stylesheet</title>
 <shortdesc class="- topic/shortdesc " xtrc="shortdesc:1;5:13" xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide\word2dita\sample-customization-transform.xml">A working example of a custom Word-to-DITA XSLT stylesheet</shortdesc>
  <prolog class="- topic/prolog " xtrc="prolog:1;6:11" xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide\word2dita\sample-customization-transform.xml">
    <author class="- topic/author " xtrc="author:1;5:21" xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide.ditamap">W. Eliot Kimber</author><metadata class="- topic/metadata " xtrc="metadata:1;7:15" xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide\word2dita\sample-customization-transform.xml">
      <keywords class="- topic/keywords " xtrc="keywords:1;8:17" xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide\word2dita\sample-customization-transform.xml">
        <indexterm class="- topic/indexterm " xtrc="indexterm:1;9:20" xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide\word2dita\sample-customization-transform.xml"/>
      </keywords>
    <prodinfo class="- topic/prodinfo " xtrc="prodinfo:1;7:27" xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide.ditamap">
    <prodname class="- topic/prodname " xtrc="prodname:1;8:15" xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide.ditamap">DITA For Publishers</prodname>
    <vrmlist class="- topic/vrmlist " xtrc="vrmlist:1;9:14" xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide.ditamap">
      <vrm class="- topic/vrm " version="0.9.16" xtrc="vrm:1;11:27" xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide.ditamap"/>
    </vrmlist>
    </prodinfo></metadata>
  </prolog>
 <conbody class="- topic/body  concept/conbody " xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide\word2dita\sample-customization-transform.xml" xtrc="conbody:1;13:11">
   <p class="- topic/p " xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide\word2dita\sample-customization-transform.xml" xtrc="p:1;14:7">To customize and extend the base Word-to-DITA transformation you need a new top-level XSLT document that includes <filepath class="+ topic/ph sw-d/filepath " xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide\word2dita\sample-customization-transform.xml" xtrc="filepath:1;14:131">docx2dita.xsl</filepath> transformation and then adds any new templates you need in order to customize processing. The following example shows an example of extending the "final-fixup" mode to capture literal numbers in topic titles.</p>
    <codeblock xml:space="preserve" class="+ topic/pre pr-d/codeblock " xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide\word2dita\sample-customization-transform.xml" xtrc="codeblock:1;15:16">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform"
  xmlns:xs="http://www.w3.org/2001/XMLSchema"
  exclude-result-prefixes="xs "
  version="2.0"&gt;
  
  &lt;xsl:import href="../../net.sourceforge.dita4publishers.word2dita/xsl/docx2dita.xsl"/&gt;
  
  &lt;xsl:template match="<b class="+ topic/ph hi-d/b " xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide\word2dita\sample-customization-transform.xml" xtrc="b:1;23:30">concept/title</b>" mode="final-fixup"&gt;
    &lt;!-- Look for numbers for the form "1-1" at the start of titles and wrap in d4pSimpleEnumeration
         element. The number must be in the first text node, not in a subelement.
    --&gt;
    &lt;xsl:variable name="childNodes" select="./node()" as="node()*"/&gt;
    &lt;xsl:message&gt; + [DEBUG] childNodes=&lt;xsl:sequence select="$childNodes"/&gt;&lt;/xsl:message&gt;
    &lt;xsl:choose&gt;
      &lt;xsl:when test="$childNodes[1]/self::text() and matches($childNodes[1], '^[0-9]+')"&gt;
        &lt;xsl:copy&gt;
          &lt;xsl:apply-templates select="@*" mode="#current"/&gt;
          &lt;xsl:analyze-string select="$childNodes[1]" regex="^(([0-9]+(-[0-9]+)*)[ ]+)(.*)"&gt;
            &lt;xsl:matching-substring&gt;
              &lt;d4pSimpleEnumeration&gt;&lt;xsl:sequence select="regex-group(1)"/&gt;&lt;/d4pSimpleEnumeration&gt;
              &lt;xsl:sequence select="regex-group(4)"/&gt;
            &lt;/xsl:matching-substring&gt;
            &lt;xsl:non-matching-substring&gt;
              &lt;xsl:sequence select="."/&gt;
            &lt;/xsl:non-matching-substring&gt;
          &lt;/xsl:analyze-string&gt;
          &lt;xsl:apply-templates select="$childNodes[position() &gt; 1]" mode="#current"/&gt;
        &lt;/xsl:copy&gt;        
      &lt;/xsl:when&gt;
      &lt;xsl:otherwise&gt;
        &lt;xsl:apply-imports/&gt;
      &lt;/xsl:otherwise&gt;
    &lt;/xsl:choose&gt;
  &lt;/xsl:template&gt;
  
&lt;/xsl:stylesheet&gt;</codeblock>
    <p class="- topic/p " xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide\word2dita\sample-customization-transform.xml" xtrc="p:2;52:8">This transform as shown is intended to be packaged in a separate Open Toolkit plugin so that it is in a known location relative to the base transform provided by the Word-to-DITA. In this example the transform is in the directory <filepath class="+ topic/ph sw-d/filepath " xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide\word2dita\sample-customization-transform.xml" xtrc="filepath:2;52:248">xsl/</filepath> under the plugin's main directory (mirroring the organization of the word-to-DITA plugin itself).</p>
    <p class="- topic/p " xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide\word2dita\sample-customization-transform.xml" xtrc="p:3;53:8">The plugin descriptor looks like this:<codeblock xml:space="preserve" class="+ topic/pre pr-d/codeblock " xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide\word2dita\sample-customization-transform.xml" xtrc="codeblock:2;53:57">&lt;!-- 
  Plugin descriptor for an example Word-to-DITA extension transform
  
  Use this as a sample for your own plugin.
  
  --&gt;
&lt;plugin id="org.example.d4p.word2ditaextension"&gt;
  &lt;require plugin="net.sourceforge.dita4publishers.word2dita"/&gt; 

  &lt;!-- This plugin just provides the transform in a reliable location
       relative to the base transform. It doesn't define its own
       transformation type.
    --&gt;
&lt;/plugin&gt;</codeblock></p>
    <p class="- topic/p " xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide\word2dita\sample-customization-transform.xml" xtrc="p:4;67:8">The directory structure of the plugin is:<codeblock xml:space="preserve" class="+ topic/pre pr-d/codeblock " xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide\word2dita\sample-customization-transform.xml" xtrc="codeblock:3;67:60">org.example.d4p.word2ditaextension/
  plugin.xml
  xsl/
    sample-word-to-dita-customization.xsl</codeblock></p>
    <p class="- topic/p " xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide\word2dita\sample-customization-transform.xml" xtrc="p:5;71:8">You would copy the <filepath class="+ topic/ph sw-d/filepath " xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide\word2dita\sample-customization-transform.xml" xtrc="filepath:3;71:37">org.example.d4p.word2ditaextension</filepath> directory to the <filepath class="+ topic/ph sw-d/filepath " xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide\word2dita\sample-customization-transform.xml" xtrc="filepath:4;71:110">plugins</filepath> directory of your Toolkit in order to make it available. Note that because this plugin doesn't define a new transformation type or directly-extend any other plugins, you don't have to run the integrator.xml script after deploying it.</p>
    <p class="- topic/p " xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide\word2dita\sample-customization-transform.xml" xtrc="p:6;72:8">To use the customization you would specify the XSLT file as the value of the <parmname class="+ topic/keyword pr-d/parmname " xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide\word2dita\sample-customization-transform.xml" xtrc="parmname:1;72:95">w2d.word2dita.xslt</parmname> Ant parameter, either on the command line or in an Ant build script that applies the Word-to-DITA process to a specific file.</p>
    <p class="- topic/p " xtrf="C:\Users\PBentley\Downloads\dita4publishers-0.9.18\documentation\d4p-users-guide\word2dita\sample-customization-transform.xml" xtrc="p:7;73:8">A working version of this plugin is included in the DITA for Publishers Open Toolkit plugin package as the plugin "org.example.d4p.word2ditaextension".</p>
 </conbody>
</concept>